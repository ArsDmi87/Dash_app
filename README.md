# Dash Admin Analytics App

Монорепозиторий аналитического приложения на Dash с административной панелью и разграничением прав доступа.

## Стек

- Python 3.10+
- Dash + dash-bootstrap-components
- Flask (серверная часть)
- SQLAlchemy + Alembic
- PostgreSQL (административная БД и БД отчётов)

## Быстрый старт

1. Создайте и активируйте виртуальное окружение:
   ```powershell
   python -m venv .venv
   .\.venv\Scripts\Activate.ps1
   ```
2. Установите зависимости:
   ```powershell
   pip install -r requirements.txt
   ```
3. Скопируйте `.env.example` в `.env` и заполните значения подключений и секретов.
4. Запустите миграции Alembic для административной БД:
   ```powershell
   alembic upgrade head
   ```
5. Запустите приложение:
   ```powershell
   python -m app.main
   ```

### Создание пользователя-администратора

Если вы запускаете приложение на новой базе, создайте учётную запись администратора перед входом:

```powershell
$env:PYTHONPATH = (Get-Location)  # если ещё не задан
python -m app.scripts.seed_admin --password "Admin123!"
```

Команда создаст (или повторно использует) роль `admin` и пользователя `admin` с указанным паролем.

> ⚠️ Пароль должен быть короче 72 байт (ограничение bcrypt); используйте более короткие или ASCII-символы.

## Структура проекта

- `app/` — исходный код приложения.
  - `auth/` — аутентификация и авторизация.
  - `admin/` — административный интерфейс и отчёты по управлению правами.
  - `reports/` — бизнес-логика и отчётные страницы.
  - `db/` — подключение к БД, модели SQLAlchemy и миграции.
  - `core/` — общие сервисы, конфигурация и вспомогательные утилиты.
  - `main.py` — точка входа приложения.
- `alembic/` — конфигурация и скрипты миграций.
- `tests/` — юнит и интеграционные тесты.

## Лицензия

Проект распространяется на условиях, определённых владельцем репозитория.
